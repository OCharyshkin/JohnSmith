language: node_js
node_js:
   - "0.10"
env:
  global:
    - secure: "JH7N4LAjAywkt010l+20n3FWsrzX2bjzvm+wKf04+IIoNp6QTkYqRFTT6uII\n1Fqs2x0H5cyPgum/ji++vdFLOKkusKTTUdqDr3a8296wdIxm3VpXCusjHqkP\nnpL5SYGuUPyAfIT5YOstO7kfk11Nuex9bWb1mmF/JcBI7P+AbLI="
script:
    - npm install -g typescript
    - tsc --out "out/john-smith-0.1.0.${TRAVIS_BUILD_NUMBER}.debug.js" --comments src/Common.ts src/Binding.ts src/View.ts src/JQuery.ts src/Debug.ts
    - "node scripts/build_tutorial.js"
    - "mkdir ${HOME}/build_artifacts"
    - "cp -R out/* ${HOME}/build_artifacts"
    - "git config --global user.email 'guryanovev@gmail.com'"
    - "git config --global user.name 'Travis'"
    - "git remote add upstream https://${GH_TOKEN}@github.com/guryanovev/JohnSmith.git"
    - "git checkout --orphan gh-pages"
    - "rm -r *"
    - "git rm -rf ."
    - "cp -R ${HOME}/build_artifacts/* ."
    - "git add -f ."
    - echo "$TRAVIS_BUILD_NUMBER"
    - git commit -q -m "Travis build $TRAVIS_BUILD_NUMBER pushed to gh-pages"
    - "git push -fq upstream gh-pages"
